!function(){"use strict";function e(e){let t=document.querySelector(`.product[data-id="${e}"]`);if(!t)return 0;let i=t.querySelector(".subtotal-price");if(i){let r=i.textContent.trim();return parseFloat(r)||0}return 0}function t(){let e=document.querySelector(".total-price");if(e){let t=e.textContent.trim();return parseFloat(t)||0}return 0}function i(e){let t={met:!0,hasStarted:!1,remainingTotal:0,remainingProduct:0,remainingTotalPrice:0,remainingProductPrice:0,productDetails:[],conditionResults:[]};if(!e.conditions)return t;if(e.conditions.multipleConditions&&Array.isArray(e.conditions.multipleConditions)){let i=e.conditions.combineLogic||"all",n=e.conditions.multipleConditions.map((e,i)=>{let n=r(e);return n.hasStarted&&(t.hasStarted=!0),{index:i,type:e.type,met:n.met,hasStarted:n.hasStarted,details:n}});if(t.conditionResults=n,"all"===i){let o=n.every(e=>e.met);t.met=o,n.forEach(e=>{!e.met&&(e.details.remainingTotal>0&&(t.remainingTotal=Math.max(t.remainingTotal,e.details.remainingTotal)),e.details.remainingProduct>0&&(t.remainingProduct=Math.max(t.remainingProduct,e.details.remainingProduct)),e.details.remainingTotalPrice>0&&(t.remainingTotalPrice=Math.max(t.remainingTotalPrice,e.details.remainingTotalPrice)),e.details.remainingProductPrice>0&&(t.remainingProductPrice=Math.max(t.remainingProductPrice,e.details.remainingProductPrice)),e.details.productDetails&&e.details.productDetails.length>0&&t.productDetails.push(...e.details.productDetails))})}else if("any"===i){let a=n.some(e=>e.met);if(t.met=a,!a){let c=n.filter(e=>!e.met),d=c.map(e=>e.details.remainingTotal).filter(e=>e>0);d.length>0&&(t.remainingTotal=Math.min(...d));let l=c.map(e=>e.details.remainingTotalPrice).filter(e=>e>0);l.length>0&&(t.remainingTotalPrice=Math.min(...l));let u=c.map(e=>e.details.remainingProduct).filter(e=>e>0);u.length>0&&(t.remainingProduct=Math.min(...u));let s=c.map(e=>e.details.remainingProductPrice).filter(e=>e>0);s.length>0&&(t.remainingProductPrice=Math.min(...s))}}return t}if(!e.conditions.type)return t;let m=r(e.conditions);return m}function r(i){let r={met:!0,hasStarted:!1,remainingTotal:0,remainingProduct:0,remainingTotalPrice:0,remainingProductPrice:0,productDetails:[]},n=i.type,o=i.productCombineLogic||i.combineLogic||"all";if("total"===n){let a=f(),c=i.minTotalQuantity||1;a>0&&(r.hasStarted=!0),a<c&&(r.met=!1,r.remainingTotal=c-a)}if("product"===n){if(i.requiredProducts&&Array.isArray(i.requiredProducts)){let d=i.requiredProducts.map(e=>{let t=p(e.id),i=e.minQuantity||1;return t>0&&(r.hasStarted=!0),{id:e.id,currentQty:t,requiredQty:i,remaining:Math.max(0,i-t),met:t>=i}});if(r.productDetails=d,"all"===o){let l=d.every(e=>e.met);l||(r.met=!1,r.remainingProduct=Math.max(...d.map(e=>e.remaining)))}else if("any"===o){let u=d.some(e=>e.met);u||(r.met=!1,r.remainingProduct=Math.min(...d.filter(e=>e.remaining>0).map(e=>e.remaining)))}}else if(i.requiredProduct){let s=i.requiredProduct,m=p(s.id),g=s.minQuantity||1;m>0&&(r.hasStarted=!0),m<g&&(r.met=!1,r.remainingProduct=g-m),r.productDetails=[{id:s.id,currentQty:m,requiredQty:g,remaining:Math.max(0,g-m),met:m>=g}]}}if("price-total"===n){let b=t(),y=i.minTotalPrice||0;b>0&&(r.hasStarted=!0),b<y&&(r.met=!1,r.remainingTotalPrice=y-b)}if("price-product"===n){if(i.requiredProducts&&Array.isArray(i.requiredProducts)){let P=i.requiredProducts.map(t=>{let i=e(t.id),n=t.minPrice||0;return i>0&&(r.hasStarted=!0),{id:t.id,currentPrice:i,requiredPrice:n,remaining:Math.max(0,n-i),met:i>=n}});if(r.productDetails=P,"all"===o){let v=P.every(e=>e.met);v||(r.met=!1,r.remainingProductPrice=Math.max(...P.map(e=>e.remaining)))}else if("any"===o){let h=P.some(e=>e.met);h||(r.met=!1,r.remainingProductPrice=Math.min(...P.filter(e=>e.remaining>0).map(e=>e.remaining)))}}else if(i.requiredProduct){let q=i.requiredProduct,C=e(q.id),k=q.minPrice||0;C>0&&(r.hasStarted=!0),C<k&&(r.met=!1,r.remainingProductPrice=k-C),r.productDetails=[{id:q.id,currentPrice:C,requiredPrice:k,remaining:Math.max(0,k-C),met:C>=k}]}}return r}function n(e,i,r,n=null,o=null){let a=window.cartConfig.notifications?.messages||{};switch(e){case"total":{let l=a.total?.pending||"Tambah {remainingTotal} item lagi untuk unlock {bumpName}",u=1,s=0;o&&void 0!==o.minTotalQuantity?u=o.minTotalQuantity:r.conditions&&void 0!==r.conditions.minTotalQuantity&&(u=r.conditions.minTotalQuantity),s=f();let m=l.replace(/{totalQuantity}/g,`<strong>${u}</strong>`).replace(/{currentTotalQuantity}/g,`<strong>${s}</strong>`).replace(/{remainingTotalQuantity}/g,`<strong>${i.remainingTotal}</strong>`).replace(/{remainingTotal}/g,`<strong>${i.remainingTotal}</strong>`).replace(/{bumpName}/g,`<strong>${r.productName}</strong>`);return`<div class="single-condition-message">${m}</div>`}case"price-total":{let g=a["price-total"]?.pending||"Tambah lagi {remainingTotalPrice} untuk unlock {bumpName}",p=0,b=t();o&&void 0!==o.minTotalPrice?p=o.minTotalPrice:r.conditions&&void 0!==r.conditions.minTotalPrice&&(p=r.conditions.minTotalPrice);let y=g.replace(/{totalPrice}/g,`<strong>${d(p)}</strong>`).replace(/{currentTotalPrice}/g,`<strong>${d(b)}</strong>`).replace(/{remainingTotalPrice}/g,`<strong>${d(i.remainingTotalPrice)}</strong>`).replace(/{bumpName}/g,`<strong>${r.productName}</strong>`);return`<div class="single-condition-message">${y}</div>`}case"product":{if(i.productDetails&&i.productDetails.length>1){let P="all";if(o&&o.productCombineLogic)P=o.productCombineLogic;else if(r.conditions.multipleConditions){let v=r.conditions.multipleConditions.find(e=>"product"===e.type&&e.requiredProducts&&e.requiredProducts.length>1);v&&(P=v.productCombineLogic||v.combineLogic||"all")}else r.conditions.requiredProducts&&r.conditions.requiredProducts.length>1&&(P=r.conditions.productCombineLogic||r.conditions.combineLogic||"all");return function e(t,i,r){let n=window.cartConfig.notifications?.messages?.multipleProducts?.[t];if(!n)return`Tambah produk yang diperlukan untuk unlock ${i.productName}`;let o=n.heading||"Sila penuhi syarat berikut untuk unlock {bumpName}:";o=o.replace(/{bumpName}/g,`<strong>${i.productName}</strong>`);let a=n.itemTemplate||"Perlukan {productQuantity} unit {productName}. Sekarang ada {currentProductQuantity} unit dalam cart, perlu tambah lagi {remainingProductQuantity} unit.",d=r.map((e,t)=>{let i=c(e.id),r=i?.name||`Produk ${e.id}`;return`<li>${a.replace(/{productQuantity}/g,`<strong>${e.requiredQty}</strong>`).replace(/{productName}/g,`<strong>${r}</strong>`).replace(/{currentProductQuantity}/g,`<strong>${e.currentQty}</strong>`).replace(/{remainingProductQuantity}/g,`<strong>${e.remaining}</strong>`)}</li>`}).join("");return`
        <div class="multi-product-notification">
            <div class="notification-heading">${o}</div>
            <ol class="notification-list">${d}</ol>
        </div>
    `}(P,r,i.productDetails)}let h="produk",q=i.productDetails?.[0]||{};if(r.conditions.multipleConditions){let C=r.conditions.multipleConditions.find(e=>"product"===e.type&&!!e.requiredProduct&&i.productDetails?.some(t=>t.id===e.requiredProduct.id));if(C?.requiredProduct){let k=c(C.requiredProduct.id);h=k?.name||`Produk ${C.requiredProduct.id}`}}else if(r.conditions.requiredProduct){let S=c(r.conditions.requiredProduct.id);h=S?.name||`Produk ${r.conditions.requiredProduct.id}`}let T=window.cartConfig.notifications?.messages||{},N=T.product?.pending||"Tambah {remainingProductQuantity} {productName} lagi untuk unlock {bumpName}",x=N.replace(/{productQuantity}/g,`<strong>${q.requiredQty||1}</strong>`).replace(/{currentProductQuantity}/g,`<strong>${q.currentQty||0}</strong>`).replace(/{remainingProductQuantity}/g,`<strong>${q.remaining||i.remainingProduct}</strong>`).replace(/{productName}/g,`<strong>${h}</strong>`).replace(/{bumpName}/g,`<strong>${r.productName}</strong>`);return`<div class="single-condition-message">${x}</div>`}case"price-product":{if(i.productDetails&&i.productDetails.length>1){let E="all";if(o&&o.productCombineLogic)E=o.productCombineLogic;else if(r.conditions.multipleConditions){let _=r.conditions.multipleConditions.find(e=>"price-product"===e.type&&e.requiredProducts&&e.requiredProducts.length>1);_&&(E=_.productCombineLogic||_.combineLogic||"all")}else r.conditions.requiredProducts&&r.conditions.requiredProducts.length>1&&(E=r.conditions.productCombineLogic||r.conditions.combineLogic||"all");return function e(t,i,r){let n=window.cartConfig.notifications?.messages?.multipleProducts?.[t];if(!n)return`Tambah harga produk yang diperlukan untuk unlock ${i.productName}`;let o=n.priceHeading||n.heading||"Sila penuhi syarat berikut untuk unlock {bumpName}:";o=o.replace(/{bumpName}/g,`<strong>${i.productName}</strong>`);let a=n.priceItemTemplate||"Perlukan {productPrice} untuk {productName}. Sekarang ada {currentProductPrice} dalam cart, perlu tambah lagi {remainingProductPrice}.",l=r.map((e,t)=>{let i=c(e.id),r=i?.name||`Produk ${e.id}`;return`<li>${a.replace(/{productPrice}/g,`<strong>${d(e.requiredPrice)}</strong>`).replace(/{productName}/g,`<strong>${r}</strong>`).replace(/{currentProductPrice}/g,`<strong>${d(e.currentPrice)}</strong>`).replace(/{remainingProductPrice}/g,`<strong>${d(e.remaining)}</strong>`)}</li>`}).join("");return`
        <div class="multi-product-notification">
            <div class="notification-heading">${o}</div>
            <ol class="notification-list">${l}</ol>
        </div>
    `}(E,r,i.productDetails)}let L="produk",Q=i.productDetails?.[0]||{};if(r.conditions.multipleConditions){let D=r.conditions.multipleConditions.find(e=>"price-product"===e.type&&!!e.requiredProduct&&i.productDetails?.some(t=>t.id===e.requiredProduct.id));if(D?.requiredProduct){let A=c(D.requiredProduct.id);L=A?.name||`Produk ${D.requiredProduct.id}`}}else if(r.conditions.requiredProduct){let I=c(r.conditions.requiredProduct.id);L=I?.name||`Produk ${r.conditions.requiredProduct.id}`}let w=window.cartConfig.notifications?.messages||{},B=w["price-product"]?.pending||"Tambah lagi {remainingProductPrice} untuk {productName} untuk unlock {bumpName}",M=B.replace(/{productPrice}/g,`<strong>${d(Q.requiredPrice||0)}</strong>`).replace(/{currentProductPrice}/g,`<strong>${d(Q.currentPrice||0)}</strong>`).replace(/{remainingProductPrice}/g,`<strong>${d(Q.remaining||i.remainingProductPrice)}</strong>`).replace(/{productName}/g,`<strong>${L}</strong>`).replace(/{bumpName}/g,`<strong>${r.productName}</strong>`);return`<div class="single-condition-message">${M}</div>`}default:return""}}function o(e){let t=e.badgeIcon||"fa-gift",i=e.badgeText||"TAWARAN ISTIMEWA";return`<strong class="notification-badge"><i class="fa ${t}"></i> ${i}</strong>`}function a(e,t,i){let r="";if(t.conditions.requiredProducts&&Array.isArray(t.conditions.requiredProducts)){let n=t.conditions.requiredProducts.map(e=>{let t=c(e.id);return t?.name||`Produk ${e.id}`});r=1===n.length?n[0]:2===n.length?n.join(" & "):n.slice(0,-1).join(", ")+" & "+n[n.length-1]}else if(t.conditions.requiredProduct){let a=c(t.conditions.requiredProduct.id);r=a?.name||"produk"}let l=e,u=o(t);return(l=(l=(l=(l=(l=(l=l.replace(/{badge}/g,u)).replace(/{bumpName}/g,`<strong>${t.productName||"order bump"}</strong>`)).replace(/{productName}/g,`<strong>${r}</strong>`)).replace(/{remainingTotal}/g,`<strong>${i.remainingTotal||0}</strong>`)).replace(/{remainingProduct}/g,`<strong>${i.remainingProduct||0}</strong>`)).replace(/{remainingTotalPrice}/g,`<strong>${d(i.remainingTotalPrice||0)}</strong>`)).replace(/{remainingProductPrice}/g,`<strong>${d(i.remainingProductPrice||0)}</strong>`)}function c(e){let t=document.querySelector(`.product[data-id="${e}"]`);if(!t)return console.warn(`Product with ID ${e} not found`),null;let i=t.querySelector("td:first-child"),r="",n=i?.querySelector(".product-name");r=n?n.textContent.trim():i?i.textContent.trim():"";let o=null,a=i?.querySelector("img.product-picture-thumb");return a&&(o=a.src||a.getAttribute("data-src")),window.cartConfig.debugMode&&console.log(`üì¶ Product ${e} found:`,r,o?"\uD83D\uDDBCÔ∏è":""),{id:e,name:r,image:o}}function d(e){let t=e.toFixed(window.cartConfig.currency.decimalPlaces);return"before"===window.cartConfig.currency.position?`${window.cartConfig.currency.symbol}${t}`:`${t}${window.cartConfig.currency.symbol}`}function l(e,t){return e-t}function u(e,t){var i,r;let n=(i=t.originalPrice,i-(r=t.discountedPrice)),o=t.savingsText.replace("{amount}",d(n)),a={"{productName}":{value:t.productName,class:"bump-product-name"},"{oldPrice}":{value:d(t.originalPrice),class:"bump-price-old"},"{newPrice}":{value:d(t.discountedPrice),class:"bump-price-new"},"{savings}":{value:o,class:"bump-save"}},c=e;return Object.entries(a).forEach(([e,t])=>{let i=RegExp(e.replace(/[{}]/g,"\\$&"),"gi");c=c.replace(i,`<span class="${t.class}">${t.value}</span>`)}),c}function s(e){if(e.productId){let t=c(e.productId);t&&(e.productName||(e.productName=t.name),t.price&&!e.discountedPrice&&(e.discountedPrice=t.price))}return e.productName?e.discountedPrice?e:(console.error("Order bump missing discountedPrice:",e),null):(console.error("Order bump missing productName:",e),null)}function m(e,t){let i=window.cartConfig.orderBumps[e];if(!i||!i.productId)return console.warn(`Order bump ${e} tidak mempunyai productId`),!1;let r=document.querySelector(`.product[data-id="${i.productId}"]`);if(!r)return console.warn(`Product dengan ID ${i.productId} tidak dijumpai`),!1;let n=r.querySelector("select.quantity");return!!n&&(n.dataset.fromBump="true","undefined"!=typeof $&&$.fn.select2?($(n).val(t.toString()),$(n).trigger("change.select2"),setTimeout(()=>{let e=new Event("input",{bubbles:!0});n.dispatchEvent(e)},50)):(n.value=t.toString(),n.dispatchEvent(new Event("change",{bubbles:!0})),n.dispatchEvent(new Event("input",{bubbles:!0}))),window.cartConfig.debugMode&&console.log(`‚úÖ Product ${i.productId} (${i.productName}) quantity set to: ${t}`),!0)}function g(){let e=window.cartConfig.orderBumpsLocation,t=null,i="beforebegin";switch(e.position){case"before-payment":default:t=document.getElementById("payment-section"),i="beforebegin";break;case"after-products":t=document.querySelector(".table.table-condensed.purchase_details:not(.table-hover)"),i="afterend";break;case"before-customer":t=document.querySelector("h2.section-header"),i="beforebegin";break;case"custom":t=document.querySelector(e.customSelector),i=e.insertMethod||"afterend"}return t||(console.error(`‚ùå Order bump target element not found for position: ${e.position}`),t=document.getElementById("payment-section"),i="beforebegin"),window.cartConfig.debugMode&&console.log(`üìç Order bump insert target:`,{position:e.position,element:t,method:i}),{targetElement:t,insertMethod:i}}function p(e){let t=document.querySelector(`.product[data-id="${e}"]`);if(!t)return 0;let i=t.querySelector("select.quantity");return i&&parseInt(i.value)||0}function f(){let e=document.querySelector(".total-quantity");return e&&parseInt(e.textContent)||0}function b(e){let t=i(e);return t.met}function y(r){let l=window.cartConfig.orderBumps[r];if(!l||!l.enabled)return;let u=document.querySelector(`.order-bump-container[data-bump-index="${r}"]`);if(!u)return;let s=i(l),m=s.met,b=s.hasStarted;!function i(r,l){if(!window.cartConfig.notifications.enabled)return;let u=window.cartConfig.orderBumps[r];if(!u||!u.conditions)return;let s=u.conditions.type||u.conditions.multipleConditions&&Array.isArray(u.conditions.multipleConditions);if(!s)return;let m=`bump-notification-${r}`,b=document.getElementById(m),y=document.querySelector(`.order-bump-container[data-bump-index="${r}"]`),P=y?.querySelector(".order-bump-input"),v=P?.checked||!1;if(v){b&&b.parentNode&&b.remove();return}if(l.met){if(window.cartConfig.notifications.showSuccessMessage){let h=function i(r,n,o,l=null){let u=window.cartConfig.notifications?.messages||{};if(o&&o.conditions&&o.conditions.multipleConditions){let s=o.conditions.combineLogic||"all",m=o.conditions.multipleConditions.length,g=null;if(1===m&&u.multiple?.successSingle)g=u.multiple.successSingle;else{let b=u.multiple?.[s];"object"==typeof b&&b.success&&(g=b.success)}if(g)return a(g,o,l);let y=u.multiple?.success||"Tahniah! Anda layak untuk <strong>{bumpName}</strong> pada harga diskaun";return y.replace(/{bumpName}/g,`<strong>${n}</strong>`)}let P=a(u[r]?.success||"Tahniah! Anda layak untuk <strong>{bumpName}</strong> pada harga diskaun",o,l);if(l&&o.conditions){if("total"===r){let v=o.conditions.minTotalQuantity||1,h=f();P=P.replace(/{totalQuantity}/g,`<strong>${v}</strong>`).replace(/{currentTotalQuantity}/g,`<strong>${h}</strong>`)}if("price-total"===r){let q=o.conditions.minTotalPrice||0,C=t();P=P.replace(/{totalPrice}/g,`<strong>${d(q)}</strong>`).replace(/{currentTotalPrice}/g,`<strong>${d(C)}</strong>`)}if("product"===r){let k="produk",S=1,T=0;if(o.conditions.requiredProduct){let N=c(o.conditions.requiredProduct.id);k=N?.name||"produk",S=o.conditions.requiredProduct.minQuantity||1,T=p(o.conditions.requiredProduct.id)}P=P.replace(/{productName}/g,`<strong>${k}</strong>`).replace(/{productQuantity}/g,`<strong>${S}</strong>`).replace(/{currentProductQuantity}/g,`<strong>${T}</strong>`)}if("price-product"===r){let x="produk",E=0,_=0;if(o.conditions.requiredProduct){let L=c(o.conditions.requiredProduct.id);x=L?.name||"produk",E=o.conditions.requiredProduct.minPrice||0,_=e(o.conditions.requiredProduct.id)}P=P.replace(/{productName}/g,`<strong>${x}</strong>`).replace(/{productPrice}/g,`<strong>${d(E)}</strong>`).replace(/{currentProductPrice}/g,`<strong>${d(_)}</strong>`)}}return P}(u.conditions.type,u.productName,u,l);if(!b){if((b=document.createElement("div")).id=m,y)y.insertAdjacentElement("beforebegin",b);else{let{targetElement:q,insertMethod:C}=g();q&&q.insertAdjacentElement("beforebegin"===C?"beforebegin":"afterend",b)}}b.className="order-bump-notification success",b.innerHTML=`
                <div class="order-bump-notification-content">
                    <div class="order-bump-notification-icon">
                        <i class="fa fa-check"></i>
                    </div>
                    <div class="order-bump-notification-text">
                        <div class="order-bump-notification-message">${h}</div>
                    </div>
                </div>
            `}else b&&b.parentNode&&b.remove();return}if(!l.met&&l.hasStarted){let k=function e(t,i,r){let c=window.cartConfig.notifications?.messages||{},d=window.cartConfig.notifications?.separators||{all:"DAN",any:"ATAU"};if(i.conditions.multipleConditions){let l=i.conditions.combineLogic||"all",u=r.conditionResults?.filter(e=>!e.met)||[],s=1===u.length,m=c.multiple?.[l],g=null;if(s&&c.multiple?.pendingSingle?g=c.multiple.pendingSingle:"string"==typeof m?g=m:m&&"object"==typeof m&&(g=m.pending),g){let p=u.map(e=>{let t=i.conditions.multipleConditions[e.index];return n(e.type,e.details,i,r,t)}).filter(e=>e);if(0===p.length)return`Unlock ${i.productName}`;let f=p.map(e=>e.includes('<div class="multi-product-notification">')||e.includes('<div class="single-condition-message">')?e:`<strong>${e}</strong>`),b="",y=d[l]||"DAN";b=1===f.length?f[0]:f.join(`<div class="condition-separator">${y}</div>`);let P=g.replace(/{conditions}/g,`<div class="conditions-text">${b}</div>`);return`<div class="multi-condition-wrapper">${P=a(P,i,r)}</div>`}return`Unlock ${o(i)}`}let v=c[t]?.pending||({total:"Tambah {remainingTotal} item lagi untuk unlock {bumpName}",product:"Tambah {remainingProduct} {productName} lagi untuk unlock {bumpName}","price-total":"Tambah lagi {remainingTotalPrice} untuk unlock {bumpName}","price-product":"Tambah lagi {remainingProductPrice} untuk {productName} untuk unlock {bumpName}"})[t];if(!v)return`Unlock ${i.productName}`;if(["product","price-product"].includes(t)){let h=r.productDetails&&r.productDetails.length>1;if(h)return n(t,r,i,r)}return a(v,i,r)}(u.conditions.type,u,l);if(!b){if((b=document.createElement("div")).id=m,y)y.insertAdjacentElement("beforebegin",b);else{let{targetElement:S,insertMethod:T}=g();S&&S.insertAdjacentElement("beforebegin"===T?"beforebegin":"afterend",b)}}b.className="order-bump-notification",b.innerHTML=`
            <div class="order-bump-notification-content">
                <div class="order-bump-notification-text">
                    <div class="order-bump-notification-message">${k}</div>
                </div>
            </div>
        `}else b&&b.parentNode&&b.remove()}(r,s);let y=u.querySelector(".order-bump-input"),P=u.querySelector(".order-bump-quantity-wrapper");b||m?(u.style.display="block",m?(u.classList.remove("disabled"),y&&(y.disabled=!1),window.cartConfig.debugMode&&console.log(`Order bump ${r} ENABLED (conditions met)`)):(u.classList.add("disabled"),y&&(y.disabled=!0,y.checked&&(y.checked=!1,y.dispatchEvent(new Event("change",{bubbles:!0})))),P&&(P.style.display="none"),window.cartConfig.debugMode&&console.log(`Order bump ${r} shown but DISABLED (conditions not met)`))):(u.style.display="none",y&&y.checked&&(y.checked=!1,y.dispatchEvent(new Event("change",{bubbles:!0}))),window.cartConfig.debugMode&&console.log(`Order bump ${r} hidden (user hasn't started ordering)`))}function P(){window.cartConfig.orderBumps.forEach((e,t)=>{e.enabled&&y(t)})}document.addEventListener("DOMContentLoaded",function(){!function e(){if(!window.cartConfig){console.error("cartConfig not found! Please define window.cartConfig before loading this script.");return}!function e(){let t=`
        <div class="cart-container">
            <div class="left-section">
                <i class="fa fa-shopping-cart" id="cartQty" data-count="0"></i>
                <span class="cart-total">0.00</span>
            </div>
            <div class="right-section">
                <button id="cart-toggle-btn">
                    <span class="toggle-btn-txt">TEMPAH SEKARANG</span>
                    <i class="fa fa-times"></i>
                </button>
            </div>
        </div>
        <div id="form-overlay"></div>
    `;document.body.insertAdjacentHTML("beforeend",t)}();let t=document.getElementById("form"),i=document.getElementById("cart-toggle-btn"),r=document.getElementById("cartQty"),n=document.getElementById("form-overlay");function o(){let e=document.querySelector(".total-quantity");if(e){let t=parseInt(e.textContent)||0;r.setAttribute("data-count",t)}}i.addEventListener("click",function(){t.classList.toggle("active"),i.classList.toggle("active"),n.classList.toggle("active")}),n.addEventListener("click",function(){t.classList.remove("active"),i.classList.remove("active"),n.classList.remove("active")});let a=document.querySelector(".total-quantity");if(a){o();let c=new MutationObserver(o);c.observe(a,{childList:!0,characterData:!0,subtree:!0})}function d(){let e=document.querySelector(".total-amount"),t=document.querySelector(".cart-total");if(e&&t){let i=e.textContent.trim();t.textContent=i}}let l=document.querySelector(".total-amount");if(l){d();let u=new MutationObserver(d);u.observe(l,{childList:!0,characterData:!0,subtree:!0})}document.querySelectorAll('input[type="radio"]').forEach(e=>{let t=document.createElement("div");t.className="radio-custom",e.insertAdjacentElement("afterend",t)}),document.querySelectorAll('input[type="checkbox"]').forEach(e=>{let t=document.createElement("div");t.className="checkbox-custom",e.insertAdjacentElement("afterend",t)})}();let e=document.querySelector(".toggle-btn-txt");e&&(e.textContent=window.cartConfig.cartButton.text);let t=document.querySelector(".cart-total");if(t&&"before"===window.cartConfig.currency.position)t.style.setProperty("--currency-symbol",`"${window.cartConfig.currency.symbol}"`);else if(t&&"after"===window.cartConfig.currency.position){let i=document.createElement("style");i.textContent=`
            .left-section .cart-total::before { content: none !important; }
            .left-section .cart-total::after { content: "${window.cartConfig.currency.symbol}"; margin-left: 2px; }
        `,document.head.appendChild(i)}let r=document.getElementById("form");r&&!r.classList.contains("active")&&(r.style.visibility="hidden",setTimeout(function(){r.style.visibility="visible"},200)),window.cartConfig.orderBumps.forEach((e,t)=>{e.enabled&&e.productId&&function e(t){let i=document.querySelector(`.product[data-id="${t}"]`);i&&(i.style.visibility="collapse",i.style.opacity="0",window.cartConfig.debugMode&&console.log(`üôà Product ${t} hidden from table`))}(e.productId)}),function e(){let t=document.querySelectorAll(".product select.quantity");t.forEach(e=>{"undefined"!=typeof $&&$.fn.select2&&$(e).on("change.select2",function(){setTimeout(()=>{P()},100)}),e.addEventListener("change",function(){setTimeout(()=>{P()},100)}),e.addEventListener("input",function(){setTimeout(()=>{P()},100)})});let i=document.querySelector(".total-quantity");if(i){let r=new MutationObserver(()=>{P()});r.observe(i,{childList:!0,characterData:!0,subtree:!0}),function e(){let t=document.querySelectorAll(".subtotal-price");t.forEach(e=>{let t=new MutationObserver(()=>{P()});t.observe(e,{childList:!0,characterData:!0,subtree:!0})});let i=document.querySelector(".total-price");if(i){let r=new MutationObserver(()=>{P()});r.observe(i,{childList:!0,characterData:!0,subtree:!0})}let n=document.querySelector(".total-amount");if(n){let o=new MutationObserver(()=>{P()});o.observe(n,{childList:!0,characterData:!0,subtree:!0})}window.cartConfig.debugMode&&console.log("\uD83D\uDCB0 Price monitoring setup complete")}(),window.cartConfig.debugMode&&console.log("\uD83D\uDC40 Quantity monitoring setup complete")}}();let{targetElement:n,insertMethod:o}=g();n&&(window.cartConfig.orderBumps.forEach((e,t)=>{if(!e.enabled)return;let i=s(e);if(!i)return;let r="";if(i.productId){let a=c(i.productId);a?.image&&(r=`
                        <div class="order-bump-image">
                            <img src="${a.image}" alt="${a.name}">
                        </div>
                    `)}let l=u(i.title,i),m=u(i.description,i),g=`order-bump-${t}`,p=`
                <div class="order-bump-container" data-bump-index="${t}">
                    <div class="order-bump-badge">
                        <i class="fa ${i.badgeIcon}"></i> ${i.badgeText}
                    </div>
                    <div class="order-bump-content">
                        <div class="bump-content-top">
                            ${r}
                            <label class="order-bump-checkbox">
                                <input type="checkbox" id="${g}-checkbox" class="order-bump-input" value="1" data-bump-index="${t}">
                                <span class="checkmark"></span>
                                <div class="order-bump-text">
                                    <div class="order-bump-title">${l}</div>
                                    <div class="order-bump-description">${m}</div>
                                </div>
                            </label>
                        </div>
                        <div class="order-bump-quantity-wrapper" id="${g}-quantity-wrapper" style="display: none;">
                            <div class="bump-quantity-left">
                                <div class="quantity-label">${i.quantityLabel}</div>
                                <div class="quantity-selector">
                                    <button type="button" class="qty-btn qty-minus" data-bump-index="${t}">
                                        <i class="fa fa-minus"></i>
                                    </button>
                                    <input type="number" class="qty-input" id="${g}-qty-input" value="${i.defaultQuantity}" min="${i.minQuantity}" max="${i.maxQuantity}" readonly data-bump-index="${t}">
                                    <button type="button" class="qty-btn qty-plus" data-bump-index="${t}">
                                        <i class="fa fa-plus"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="quantity-total">
                                <span class="bump-total-price" id="${g}-total-price">${d(i.discountedPrice)}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;n.insertAdjacentHTML(o,p)}),setTimeout(()=>{document.querySelectorAll(".order-bump-input").forEach(e=>{let t=parseInt(e.getAttribute("data-bump-index")),i=s(window.cartConfig.orderBumps[t]);if(!i)return;let r=`order-bump-${t}`,n=document.getElementById(`${r}-quantity-wrapper`),o=document.getElementById(`${r}-qty-input`),a=document.getElementById(`${r}-total-price`),c=document.querySelector(`.qty-minus[data-bump-index="${t}"]`),l=document.querySelector(`.qty-plus[data-bump-index="${t}"]`);function u(){let r=parseInt(o.value)||1,n=i.discountedPrice*r;a.textContent=d(n),e.checked&&m(t,r),window.cartConfig.debugMode&&console.log(`Order bump ${t} total: ${d(n)}`)}function g(){let e=parseInt(o.value)||1;c&&(c.disabled=e<=i.minQuantity),l&&(l.disabled=e>=i.maxQuantity)}g(),e.addEventListener("change",function(){if(this.checked){n.style.display="flex";let e=parseInt(o.value)||i.defaultQuantity;if(setTimeout(()=>{m(t,e)},100),u(),i.productId){let r=parseInt(o.value)||i.defaultQuantity;!function e(t,i){let r=document.querySelector(`.product[data-id="${t}"]`);if(r){r.style.visibility="visible",r.style.opacity="1";let n=r.querySelector("td:first-child");if(n&&!n.querySelector(".order-bump-badge-table")){let o=document.createElement("div");o.className="order-bump-badge-table",o.textContent=window.cartConfig.bumpsBadge.text;let a=n.querySelector(".product-description");a?n.insertBefore(o,a):n.appendChild(o)}let c=r.querySelector(".quantity");c&&(c.disabled=!0,c.style.opacity="0.6",c.style.cursor="not-allowed"),window.cartConfig.debugMode&&console.log(`üëÅÔ∏è Product ${t} shown as Order Bump`)}}(i.productId,r)}y(t),window.cartConfig.debugMode&&console.log(`‚úÖ Order bump ${t} selected:`,i.productName)}else{var a;n.style.display="none",m(a=t,0),i.productId&&function e(t){let i=document.querySelector(`.product[data-id="${t}"]`);if(i){i.style.visibility="collapse",i.style.opacity="0";let r=i.querySelector(".order-bump-badge-table");r&&r.remove();let n=i.querySelector(".quantity");n&&(n.disabled=!1,n.style.opacity="1",n.style.cursor="pointer"),window.cartConfig.debugMode&&console.log(`üîÑ Product ${t} reset and hidden`)}}(i.productId),y(t),window.cartConfig.debugMode&&console.log(`‚ùå Order bump ${t} deselected`)}}),c&&c.addEventListener("click",function(e){e.preventDefault();let t=parseInt(o.value)||1;t>i.minQuantity&&(o.value=t-1,u(),g())}),l&&l.addEventListener("click",function(e){e.preventDefault();let t=parseInt(o.value)||1;t<i.maxQuantity&&(o.value=t+1,u(),g())}),o&&o.addEventListener("change",function(){let e=parseInt(this.value)||1;e<i.minQuantity&&(e=i.minQuantity),e>i.maxQuantity&&(e=i.maxQuantity),this.value=e,u(),g()})}),P()},500),window.cartConfig.debugMode&&console.log("\uD83C\uDF81 Order Bumps loaded:",window.cartConfig.orderBumps.filter(e=>e.enabled).length,"active"))})}();
